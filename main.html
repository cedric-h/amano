<!DOCTYPE html>
<html lang="en">
<head>
  <title>help im trapped in stick man factory</title>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="description" content="" />
  <style>
  body {
    margin: 0px;
    padding: 0px;
    width: 100vh;
    height: 100vh;
    overflow: hidden;
    background: snow;
    color: white;
    font-family: sans-serif;
  }
  canvas {
    width: 100vw;
    height: 100vh;
  }
  </style>
</head>
<body>
  <canvas id="draw"></canvas>
  <script src=wahook.js></script>
  <script>
/* "with great power, comes great renamability" - max wofford */

let canvas = null, ctx, wasm_instance = null;

window.addEventListener("resize", (e) => {
  if (canvas) {
    canvas.width = window.innerWidth
    canvas.height = window.innerHeight
  }
})

function frameHandler() {
  wasm_instance.exports.frame();
  window.requestAnimationFrame(frameHandler);
}

window.addEventListener("load", () => {
  canvas = document.getElementById("draw");
  canvas.width = window.innerWidth
  canvas.height = window.innerHeight
  ctx = canvas.getContext("2d");
  ctx.fillStyle = "black";
  (async () => {
    const wasm = fetch("build/main.wasm");
    const { instance } =
      await WebAssembly.instantiateStreaming(wasm, { env: {
        putrect: w => {
          ctx.fillRect(...new Int32Array(instance.exports.memory.buffer, w, 4))
        }
      } });

      instance.exports.init();
      wasm_instance = instance
      window.requestAnimationFrame(frameHandler)
  })()
})
</script>
</body>
</html>
